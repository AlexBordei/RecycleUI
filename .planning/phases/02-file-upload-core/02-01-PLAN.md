---
phase: 02-file-upload-core
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [app/Filament/Pages/Upload.php, resources/views/filament/pages/upload.blade.php]
autonomous: true
---

<objective>
Create the foundation for file upload functionality with a Filament page and drag-drop upload zone.

Purpose: Establish the upload interface where users will submit their zip archives.
Output: Working Filament page with drag-and-drop file input and click-to-upload fallback.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
@app/Providers/Filament/AdminPanelProvider.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Filament Upload page</name>
  <files>app/Filament/Pages/Upload.php</files>
  <action>
    Create a new Filament page for file uploads:

    1. Create `app/Filament/Pages/Upload.php` extending `Filament\Pages\Page`
    2. Set navigation:
       - Icon: `heroicon-o-arrow-up-tray`
       - Label: "Upload Archive"
       - Navigation group: none (top level)
       - Sort order: 1 (first item after dashboard)
    3. Set page title: "Upload Zip Archive"
    4. Create corresponding Blade view at `resources/views/filament/pages/upload.blade.php`
    5. Page should be accessible only to authenticated users (default Filament behavior)

    The page will use Livewire for file upload handling (Filament pages are Livewire components).
  </action>
  <verify>Visit http://localhost:8000/admin/upload - page loads with title "Upload Zip Archive"</verify>
  <done>Upload page exists in Filament navigation and renders without errors</done>
</task>

<task type="auto">
  <name>Task 2: Implement drag-drop file upload with click fallback</name>
  <files>app/Filament/Pages/Upload.php, resources/views/filament/pages/upload.blade.php</files>
  <action>
    Implement the upload zone using Livewire's native file upload:

    1. In Upload.php:
       - Add `use Livewire\WithFileUploads;` trait
       - Add public property: `public $archive;`
       - Add temporary file storage configuration

    2. In upload.blade.php, create styled upload zone:
       ```html
       <div class="upload-zone"
            x-data="{ isDragging: false }"
            x-on:dragover.prevent="isDragging = true"
            x-on:dragleave.prevent="isDragging = false"
            x-on:drop.prevent="isDragging = false; $refs.fileInput.files = $event.dataTransfer.files; $refs.fileInput.dispatchEvent(new Event('change'))">

           <!-- Visual drop zone -->
           <div :class="{ 'border-primary-500 bg-primary-50': isDragging }"
                class="border-2 border-dashed border-gray-300 rounded-lg p-12 text-center">

               <x-heroicon-o-cloud-arrow-up class="w-12 h-12 mx-auto text-gray-400" />

               <p class="mt-4 text-lg font-medium text-gray-900">
                   Drag and drop your zip file here
               </p>
               <p class="mt-2 text-sm text-gray-500">
                   or
               </p>

               <!-- Click to upload button (fallback) -->
               <label class="mt-4 inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg cursor-pointer hover:bg-primary-700">
                   <span>Browse Files</span>
                   <input type="file"
                          wire:model="archive"
                          x-ref="fileInput"
                          accept=".zip,application/zip"
                          class="hidden" />
               </label>
           </div>
       </div>
       ```

    3. Add Tailwind/Filament styling for consistent look with admin panel

    4. Show selected filename after file is chosen:
       ```blade
       @if($archive)
           <div class="mt-4 p-4 bg-gray-100 rounded-lg flex items-center justify-between">
               <span class="text-sm text-gray-700">{{ $archive->getClientOriginalName() }}</span>
           </div>
       @endif
       ```

    Requirements covered:
    - UPLD-01: Drag-and-drop onto upload zone
    - UPLD-02: Click button to open file picker as fallback
  </action>
  <verify>
    1. Visit /admin/upload
    2. Drag a file over the zone - border changes color
    3. Drop a file - filename appears
    4. Click "Browse Files" button - file picker opens
    5. Select file - filename appears
  </verify>
  <done>
    - Drag-and-drop visually responds and accepts files
    - Click-to-upload button opens file picker
    - Selected filename displays after choosing file
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `php artisan route:list | grep upload` shows upload route
- [ ] Upload page accessible at /admin/upload
- [ ] Drag-and-drop zone responds to drag events
- [ ] File picker opens on button click
- [ ] Selected file name displays after selection
</verification>

<success_criteria>
- Upload page integrated into Filament navigation
- Drag-and-drop file upload works (UPLD-01)
- Click-to-upload fallback works (UPLD-02)
- Page follows Filament design patterns
- Ready for validation and progress features
</success_criteria>

<output>
After completion, create `.planning/phases/02-file-upload-core/02-01-SUMMARY.md`
</output>
